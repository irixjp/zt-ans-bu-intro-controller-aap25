= ãƒ©ãƒœã‚¬ã‚¤ãƒ‰: è¤‡æ•°ã® Job Template ã‚’ä½œæˆã™ã‚‹
:notoc:
:toc-title: Table of Contents
:nosectnums:
:icons: font

_ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ç•°ãªã‚‹ playbook ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€2ã¤ç›®ã¨3ã¤ç›®ã® Job Template ã‚’ä½œæˆã™ã‚‹ã‚¬ã‚¤ãƒ‰ã€‚_

---

== ãƒ©ãƒœæ¦‚è¦

automation controller ã§ã¯ã€**job templates** ã¯ `ansible-playbook` ã‚³ãƒãƒ³ãƒ‰ã¨ã€CLI å®Ÿè¡Œæ™‚ã«ä½¿ãˆã‚‹å„ç¨®ãƒ•ãƒ©ã‚°ã‚’è¦–è¦šåŒ–ã—ãŸã‚‚ã®ã§ã™ã€‚Ansible Playbook ã‚’å®Ÿè¡Œã™ã‚‹ä¸»è¦ãªä»•çµ„ã¿ã§ã™ã€‚

image::job-templates-home-with-example-job-template.png[Job Templates list view in automation controller, opts="border"]

---

== ãƒ©ãƒœã‚¬ã‚¤ãƒ‰: ãƒãƒ³ã‚ºã‚ªãƒ³ã‚¿ã‚¹ã‚¯

ã“ã‚Œã¾ã§ã«å­¦ã‚“ã å†…å®¹ã‚’ä½¿ã£ã¦ã€2 ã¤ç›®ã¨ 3 ã¤ç›®ã® **Job Template** ã‚’ä½œæˆã—ã¾ã™ã€‚

* 2 ã¤ç›®ã® Job Template `Extended services` ã§ã¯ã€`extended_services.yml` playbook ã‚’ä½¿ã£ã¦ `node3` ã« PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚
* 3 ã¤ç›®ã® Job Template `Set motd` ã§ã¯ã€`motd_facts.yml` playbook ã‚’ä½¿ã£ã¦ `node1` ã« message of the day ã‚’è¨­å®šã—ã¾ã™ã€‚

NOTE: ã“ã®æ¼”ç¿’ã§ã¯ã€åŒã˜ Project å†…ã®ç•°ãªã‚‹ playbook ã‚’è¤‡æ•° Job Template ã§ä½¿ã„åˆ†ã‘ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

[IMPORTANT]
====
automation controller ã¸ã®ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼æƒ…å ±:

* *Username:* `admin`
* *Password:* `ansible123!`
====

=== Task 1: "Extended Services" Job Template ã‚’ä½œæˆã™ã‚‹

æœ€åˆã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ job template ã‚’ä½œæˆã—ã¾ã™ã€‚

. **Templates ãƒšãƒ¼ã‚¸ã¸ç§»å‹•ã™ã‚‹ã€‚**
+
å·¦å´ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ **Automation Execution** â†’ **Templates** ã«ç§»å‹•ã—ã¾ã™ã€‚

. **æ–°ã—ã„ job template ã‚’ä½œæˆã™ã‚‹ã€‚**
+
é’è‰²ã® **Create template** ãƒœã‚¿ãƒ³ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã€**Create job template** ã‚’é¸æŠã—ã¾ã™ã€‚

. **job template ã®è©³ç´°ã‚’å…¥åŠ›ã™ã‚‹ã€‚**
+
ãƒ•ã‚©ãƒ¼ãƒ ã«ä»¥ä¸‹ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
+
* **Name:** `Extended services`
* **Job Type:** `Run`
* **Inventory:** `Lab-Inventory`
* **Project:** `Additional playbooks`
* **Playbook:** `extended_services.yml`
* **Credentials:** `lab-credentials` ã‚’é¸æŠ
* **Privilege Escalation:** `become` ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ **ãƒã‚§ãƒƒã‚¯**

. **job template ã‚’ä¿å­˜ã™ã‚‹ã€‚**
+
ä»–ã®é …ç›®ã¯ãã®ã¾ã¾ã«ã—ã¦ã€é’è‰²ã® **Create job template** ãƒœã‚¿ãƒ³ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã¾ã™ã€‚

[IMPORTANT]
====
**Credentials** ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ UI ä¸Šã§å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€æ­£ã—ã„ machine credentials ã‚’é¸æŠã—ãªã„ã¨ã‚¸ãƒ§ãƒ–ã¯å¤±æ•—ã—ã¾ã™ã€‚
====

=== Task 2: "Extended Services" Job Template ã‚’èµ·å‹•ã™ã‚‹

æ¬¡ã« template ã‚’èµ·å‹•ã—ã€æƒ³å®šã•ã‚Œã‚‹å¤±æ•—ã‚’ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒˆã—ã¾ã™ã€‚

. **template ã‚’èµ·å‹•ã™ã‚‹ã€‚**
+
**Templates** ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã€`Extended services` job template ã®æ¨ªã«ã‚ã‚‹ **Launch** ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆğŸš€ï¼‰ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã¾ã™ã€‚

. **å¤±æ•—ã‚’ç¢ºèªã—ã¦è§£æ¶ˆã™ã‚‹ã€‚**
+
ã‚¸ãƒ§ãƒ–å®Ÿè¡Œã¯ **å¤±æ•—** ã—ã¾ã™ã€‚å‡ºåŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿ã€ç†ç”±ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚playbook ã¯ `[database]` group å†…ã® `node3` ã¨ã„ã† host ã‚’å¯¾è±¡ã«ã—ã¦ã„ã¾ã™ãŒã€`Lab-Inventory` ã«ã©ã¡ã‚‰ã‚‚å­˜åœ¨ã—ã¾ã›ã‚“ã€‚

. **inventory ã‚’æ›´æ–°ã™ã‚‹ã€‚**
+
inventory ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã§å­¦ã‚“ã å†…å®¹ã‚’ä½¿ã£ã¦ `Lab-Inventory` ã«æˆ»ã‚Šã€æ¬¡ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚
+
--
* `node3` ã¨ã„ã†æ–°ã—ã„ host ã‚’ **ä½œæˆ**
* `database` ã¨ã„ã†æ–°ã—ã„ group ã‚’ **ä½œæˆ**
* `database` group ã« `node3` host ã‚’ **è¿½åŠ **
--

. **ã‚¸ãƒ§ãƒ–ã‚’å†èµ·å‹•ã™ã‚‹ã€‚**
+
`Extended services` job template ã‚’å†åº¦ **Launch** ã—ã€ä»Šåº¦ã¯æˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

=== Task 3: "Set motd" Job Template ã‚’ä½œæˆã™ã‚‹

æ¬¡ã«ã€å­¦ã‚“ã å†…å®¹ã‚’ä½¿ã£ã¦ 3 ã¤ç›®ã® job template ã‚’ä½œæˆã—ã¾ã™ã€‚

. **Templates ãƒšãƒ¼ã‚¸ã¸ç§»å‹•ã™ã‚‹ã€‚**
+
**Automation Execution** â†’ **Templates** ã«ç§»å‹•ã—ã¾ã™ã€‚

. **æ–°ã—ã„ job template ã‚’ä½œæˆã™ã‚‹ã€‚**
+
**Create template** ãƒœã‚¿ãƒ³ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã€**Create job template** ã‚’é¸æŠã—ã¾ã™ã€‚

. **job template ã®è©³ç´°ã‚’å…¥åŠ›ã™ã‚‹ã€‚**
+
ãƒ•ã‚©ãƒ¼ãƒ ã«ä»¥ä¸‹ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
+
* **Name:** `Set motd`
* **Inventory:** `Lab-Inventory`
* **Project:** `Additional playbooks`
* **Playbook:** `motd_facts.yml`
* **Credentials:** `lab-credentials` ã‚’é¸æŠ
* **Privilege Escalation:** ã“ã®ãƒœãƒƒã‚¯ã‚¹ã‚’ **ãƒã‚§ãƒƒã‚¯**

. **job template ã‚’ä¿å­˜ã™ã‚‹ã€‚**
+
é’è‰²ã® **Create job template** ãƒœã‚¿ãƒ³ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã¾ã™ã€‚

=== Task 4: "Set motd" Job Template ã‚’èµ·å‹•ã™ã‚‹

æœ€å¾Œã«ã€æ–°ã—ã„ template ã‚’èµ·å‹•ã—ã¦ message of the day ã‚’è¨­å®šã—ã¾ã™ã€‚

. **template ã‚’èµ·å‹•ã™ã‚‹ã€‚**
+
**Templates** ä¸€è¦§ã§ã€`Set motd` job template ã®æ¨ªã«ã‚ã‚‹ **Launch** ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆğŸš€ï¼‰ã‚’ **ã‚¯ãƒªãƒƒã‚¯** ã—ã¾ã™ã€‚

. **å®Ÿè¡ŒæˆåŠŸã‚’ç¢ºèªã™ã‚‹ã€‚**
+
ã‚¸ãƒ§ãƒ–ãŒ **Successful** ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§å®Œäº†ã™ã‚Œã°æˆåŠŸã§ã™ã€‚

---

== æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

æ¬¡ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«é€²ã‚€ã«ã¯ã€ä¸‹ã® `Check` ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚

== ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã‚„ä¸å…·åˆã‚’è¦‹ã¤ã‘ãŸå ´åˆã¯ã€link:https://github.com/ansible/instruqt/issues/new?labels=controller-101&title=controller-101+slug+ID:+controller-101-template-extended&assignees=leogallego[GitHub ã§ issue ã‚’ä½œæˆã—ã¦ãã ã•ã„]ã€‚
