= ラボガイド: Inventory の作成
:notoc:
:toc-title: Table of Contents
:nosectnums:
:icons: font

_automation controller で inventory を作成して内容を追加し、hosts と groups を簡単に管理するためのガイド。_

---

== ラボ概要

このセクションでは、Ansible Automation Platform の inventories について概要を説明します。

=== Inventories とは

**inventory** は、playbook 内のコマンド、モジュール、タスクの実行対象となる hosts と host groups を定義します。Ansible と automation controller が管理対象システムを把握するための基本的な仕組みです。

image::Oct-16-2024_at_02.39.15-image.png[Inventories list view in automation controller, opts="border"]

このチャレンジでは、新しい inventory を作成し、hosts を追加して、それらを整理する group を作成します。

image::Oct-16-2024_at_02.39.47-image.png[Creating a new inventory, opts="border"]

---

== ラボガイド: ハンズオンタスク

inventory は、ジョブ（playbook など）を実行する対象 hosts の集合です。Ansible の inventory file と同じ考え方ですが、強力な UI と追加機能があります。

inventories は *groups* に分かれ、各 group に実際の *hosts* が含まれます。hosts は IP アドレスまたはホスト名で指定でき、手動またはクラウドプロバイダーからの動的取得で登録できます。

[IMPORTANT]
====
automation controller の認証情報:

* *Username:* `admin`
* *Password:* `ansible123!`
====

=== Task 1: Inventory を作成する

最初に、管理対象ノードを格納する空の inventory を作成します。

. **Inventories ページへ移動する。**
+
左側ナビゲーションメニューで **Infrastructure** → **Inventories** に移動します。

. **新しい inventory を作成する。**
+
青色の **Create inventory** ボタンを **クリック** し、ドロップダウンで **Create inventory** を選択します。

. **inventory の詳細を入力する。**
+
フォームに以下を入力します。
+
* **Name:** `Lab-Inventory`
* **Organization:** `Default`

. **inventory を保存する。**
+
青色の **Create inventory** ボタンを **クリック** します。

=== Task 2: Inventory に Hosts を追加する

次に、新しい inventory に 2 台の host を手動で追加します。

NOTE: `Lab-Inventory` の詳細ページにいない場合は、inventory 一覧で名前をクリックして戻ってください。

. **Hosts タブへ移動する。**
+
`Lab-Inventory` 内で **Hosts** タブを **クリック** します。

. **最初の host を作成する。**
+
青色の **Create host** ボタンを **クリック** します。*Name* フィールドに `node1` を入力し、他は変更せずに *Create host* を **クリック** します。

. **2つ目の host を作成する。**
+
**< Back to Hosts** のパンくずリンクをクリックして hosts 一覧に戻ります。上記手順を **繰り返し**、`node2` という名前の 2 つ目の host を作成します。

=== Task 3: Group を作成する

groups は hosts の整理や、複数 host への変数適用に使います。

. **Groups タブへ移動する。**
+
`Lab-Inventory` のメインページに戻り、**Groups** タブを **クリック** します。

. **新しい group を作成する。**
+
青色の **Create group** ボタンを **クリック** します。

. **group 名を設定する。**
+
*Name* フィールドに `web` を入力します。
+
NOTE: 静的 inventory file と異なり、UI では group 名を `[]` で囲む必要はありません。

. **group を保存する。**
+
青色の **Create group** ボタンを **クリック** します。

=== Task 4: Group に Hosts を追加する

最後に、作成した `web` group に 2 台の host を関連付けます。

. **group の Hosts タブへ移動する。**
+
作成した `web` group の中で **Hosts** タブを **クリック** します。

. **既存 host を追加する。**
+
青色の **Add existing host** ボタンを **クリック** します。

. **hosts を選択する。**
+
ポップアップで `node1` と `node2` の両方に **チェック** を入れ、*Add hosts* を **クリック** します。

. **関連付けを確認する。**
+
`web` group の *Hosts* タブに `node1` と `node2` が表示されていれば完了です。

---

== 次のステップ

次のチャレンジに進むには、下の `Check` ボタンを押してください。

== トラブルシューティング

問題が発生した場合や不具合を見つけた場合は、link:https://github.com/ansible/workshops/issues/new?labels=controller-101&title=Issue+with+Intro+to+Controller+slug+ID:+controller-101-inventory+AAP25&assignees=leogallego[GitHub で issue を作成してください]。
